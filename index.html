<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>RDV — GDR</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="styles.css?v=250909-23">
</head>
<body>
  <div class="max-w-5xl mx-auto p-4 md:p-8 space-y-6">
    <!-- ===== KPI CARD (logos + encabezado bilingüe + código) ===== -->
    <section class="card soft p-4 md:p-6 space-y-4 kpi-card">
      <div class="logo-bar">
        <img src="ECUACORRIENTE.png" alt="Logo izquierdo" class="rdv-logo" onerror="this.style.display='none'">
        <img src="LOGO GDR.jpeg" alt="Logo derecho" class="rdv-logo" onerror="this.style.display='none'">
      </div>

      <!-- Encabezado bilingüe centrado (pantalla) -->
      <div class="bilingual-title">
        <div class="line1">SISTEMA DE GESTIÓN DE LA CALIDAD <span class="cn">质量管理体系</span></div>
        <div class="line2">DEPARTAMENTO DE GESTIÓN DE DEPÓSITOS DE RELAVES <span class="cn">尾矿库管理部</span></div>
        <div class="sep"></div>
        <div class="line3">
          <div class="es">Revisión Diaria de Vehículos</div>
          <div class="cn">车辆日常检查</div>
        </div>
      </div>


    </section>

    <!-- ====== FORM ====== -->
    <form id="rdvForm" class="card soft p-4 md:p-6 space-y-6 no-print">
      <h2 class="text-xl font-semibold">1) Datos generales</h2>
      <div class="grid-2">
        <div class="space-y-3">
          <label class="block text-sm">Código del vehículo <span class="text-red-400">*</span>
            <input id="cod" required maxlength="25" class="w-full mt-1 bg-black/30 border border-white/15 rounded-lg px-3 py-2" placeholder="ECO62, CAM-01, etc.">
          </label>
          <label class="block text-sm">Placa <span class="text-red-400">*</span>
            <input id="placa" required maxlength="20" class="w-full mt-1 bg-black/30 border border-white/15 rounded-lg px-3 py-2" placeholder="ABC-1234">
          </label>
          <label class="block text-sm">Kilometraje actual <span class="text-red-400">*</span>
            <input id="km" type="number" min="0" step="1" required class="w-full mt-1 bg-black/30 border border-white/15 rounded-lg px-3 py-2" placeholder="123456">
          </label>
        </div>
        <div class="space-y-3">
          <label class="block text-sm">Fecha y hora de la revisión <span class="text-red-400">*</span>
            <input id="fecha" type="datetime-local" required class="w-full mt-1 bg-black/30 border border-white/15 rounded-lg px-3 py-2">
          </label>
          <label class="block text-sm">Conductor responsable
            <input id="conductor" class="w-full mt-1 bg-black/30 border border-white/15 rounded-lg px-3 py-2" placeholder="Nombre completo">
          </label>
          <label class="block text-sm">Inspector / Gestor GDR
            <input id="inspector" class="w-full mt-1 bg-black/30 border border-white/15 rounded-lg px-3 py-2" placeholder="Nombre completo">
          </label>
          <label class="block text-sm">Ubicación
            <input id="ubicacion" class="w-full mt-1 bg-black/30 border border-white/15 rounded-lg px-3 py-2" placeholder="Ciudad / Frente / Taller">
          </label>
        </div>
      </div>

      <h2 class="text-xl font-semibold">2) Evaluación de sistemas</h2>
      <p class="note">Marca el estado de cada sistema. Si seleccionas <span class="text-yellow-400 font-semibold">Atención</span> o <span class="text-red-400 font-semibold">Crítico</span>, agrega una observación.</p>

      <div class="overflow-x-auto">
        <table class="min-w-full text-sm border border-white/10 rounded-lg overflow-hidden">
          <thead class="bg-white/10">
            <tr>
              <th class="text-left p-2">Sistema</th>
              <th class="text-left p-2">Estado</th>
              <th class="text-left p-2">Observación (opcional)</th>
            </tr>
          </thead>
          <tbody id="sysTableBody" class="divide-y divide-white/10">
            <!-- rows injected by JS -->
          </tbody>
        </table>
      </div>

      <div class="grid-2">
        <fieldset class="space-y-2">
          <legend class="text-sm font-semibold">ESTADO</legend>
          <label class="inline-flex items-center gap-2">
            <input type="radio" name="apto" id="aptoSi" value="SI" class="accent-emerald-400" checked>
            <span class="text-emerald-400 font-semibold">OPERATIVO</span>
          </label>
          <label class="inline-flex items-center gap-2">
            <input type="radio" name="apto" id="aptoNo" value="NO" class="accent-rose-500">
            <span class="text-rose-400 font-semibold">MANT. PREVENTIVO</span>
          </label>
          <label class="inline-flex items-center gap-2">
            <input type="radio" name="apto" id="aptoNo" value="NO" class="accent-rose-500">
            <span class="text-rose-400 font-semibold">MANT. CORRECTIVO</span>
          </label>
        </fieldset>

        <div class="space-y-2">
          <label class="block text-sm">Observaciones generales</label>
          <textarea id="obsGeneral" rows="2" class="w-full bg-black/30 border border-white/15 rounded-lg p-3" placeholder="Notas adicionales, recomendaciones, repuestos requeridos, etc."></textarea>
        </div>
      </div>

      <h2 class="text-xl font-semibold">3) Evidencia fotográfica (obligatoria)</h2>
      <div class="grid-2">
        <label class="block text-sm">Foto 1
          <input id="foto1" type="file" accept="image/*" capture="environment" required class="mt-1 block w-full file:mr-4 file:py-2 file:px-3 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-sky-600 file:text-white hover:file:bg-sky-500">
          <img id="prev1" class="thumb mt-2 hidden" alt="Vista previa 1">
        </label>
        <label class="block text-sm">Foto 2
          <input id="foto2" type="file" accept="image/*" capture="environment" required class="mt-1 block w-full file:mr-4 file:py-2 file:px-3 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-sky-600 file:text-white hover:file:bg-sky-500">
          <img id="prev2" class="thumb mt-2 hidden" alt="Vista previa 2">
        </label>
      </div>

      <div class="flex flex-wrap gap-2 pt-2">
        <button id="btnGenerar" type="button" class="btn btn-primary">Generar informe</button>
        <button id="btnImprimir" type="button" class="btn btn-ghost border-white/20 disabled:opacity-50" disabled>Imprimir / Guardar PDF <span class="kbd ml-1">Ctrl/Cmd+P</span></button>
        <button id="btnLimpiar" type="button" class="btn btn-danger">Limpiar</button>
      </div>
      <p class="note">Sugerencia: después de generar el informe, presiona el botón "Imprimir / Guardar PDF". Tu navegador usará el <span class="font-mono">código RDV</span> como nombre sugerido del archivo.</p>
    </form>

    <!-- ====== PRINTABLE REPORT (A4) ====== -->
    <section id="report" class="print-only">

      <div class="rep-card" style="margin-bottom:8px;">
        <table class="rep-table">
          <tr>
            <th style="width:24%;">Fecha y hora</th><td id="rep-fecha"></td>
            <th style="width:16%;">ESTADO</th><td id="rep-apto" style="font-weight:700;"></td>
          </tr>
          <tr>
            <th>Código vehículo</th><td id="rep-cod"></td>
            <th>Placa</th><td id="rep-placa"></td>
          </tr>
          <tr>
            <th>Kilometraje</th><td id="rep-km"></td>
            <th>Cod. Reporte</th><td id="rep-arch"></td>
          </tr>
          <tr>
            <th>Conductor</th><td id="rep-conductor"></td>
            <th>Inspector</th><td id="rep-inspector"></td>
          </tr>
        </table>
      </div>

      <div class="rep-card" style="margin-bottom:8px;">
        <div style="font-weight:700; margin-bottom:4px;">Evaluación de sistemas</div>
        <table class="rep-table" id="rep-sys">
          <thead>
            <tr><th style="width:28%;">Sistema</th><th style="width:14%;">Estado</th><th>Observación</th></tr>
          </thead>
          <tbody id="rep-sys-body"></tbody>
        </table>
      </div>

      
        <!-- Observaciones generales (impresión) -->
        <div class="rep-obs-block">
          <div class="rep-obs-title">Observaciones generales</div>
          <div id="rep-obs" class="rep-obs-content">—</div>
        </div>

        <div class="print-grid">
          <figure>
            <img id="rep-img1" alt="Foto 1">
            <figcaption style="font-size:12px; text-align:center;">Foto 1</figcaption>
          </figure>
          <figure>
            <img id="rep-img2" alt="Foto 2">
            <figcaption style="font-size:12px; text-align:center;">Foto 2</figcaption>
          </figure>
        </div>
      </div>

      <footer style="margin-top:8px; display:flex; gap:20px;">
        <div style="flex:1;">
          <div style="height:40px;"></div>
          <div style="border-top:1px solid #000; text-align:center; font-size:12px;">Firma Conductor</div>
        </div>
        <div style="flex:1;">
          <div style="height:40px;"></div>
          <div style="border-top:1px solid #000; text-align:center; font-size:12px;">Firma Inspector</div>
        </div>
      </footer>
    </section>

    <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 bg-black/80 text-white px-4 py-2 rounded-lg border border-white/20 shadow-lg hidden"></div>
  </div>
  <script src="app.js?v=250909-23"></script>
</body>
</html>